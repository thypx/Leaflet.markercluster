<!DOCTYPE html>
<html>

<head>
	<title>Leaflet debug page</title>

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
		integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
		crossorigin="" />
	<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet-src.js"
		integrity="sha512-WXoSHqw/t26DszhdMhOXOkI7qCiv5QWXhH9R7CgvgZMHz1ImlkVQ3uNsiQKu5wwbbxtPzFXd1hK4tzno2VqhpA=="
		crossorigin=""></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="screen.css" />

	<link rel="stylesheet" href="../dist/MarkerCluster.css" />
	<link rel="stylesheet" href="../dist/MarkerCluster.Default.css" />
	<script src="../dist/leaflet.markercluster-src.js"></script>

	<script src="realworld.10000.js"></script>

</head>

<body>

	<div id="map"></div>
	<span>Mouse over a cluster to see the bounds of its children and click a cluster to zoom to those bounds</span>
	<script type="text/javascript">

		var tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Points &copy 2012 LINZ'
		}),
			latlng = L.latLng(-37.89, 175.46);

		
		// 设置最小聚类层级
		// 小于此值则不组内独立聚类
		// 大于等于此值，则按照默认聚类方式
		const maxClusterNum = 100

		var map = L.map('map', { center: latlng, zoom: 13, layers: [tiles] });

		var markers = L.markerClusterGroup({
			chunkedLoading: true,
			maxClusterNum,
			iconCreateFunction: function (cluster) {
				var childCount = cluster.getChildCount();
				var markers  = cluster.getAllChildMarkers()

				var c = ' marker-cluster-';
				if (childCount >= maxClusterNum) {
					c += 'large';
				} else if (markers[0].options.groupName === 'group1') {
					c += 'medium';
				} else {
					c += 'small';
				}

				return new L.DivIcon({ html: '<div><span>' + childCount + ' <span aria-label="markers"></span>' + '</span></div>', className: 'marker-cluster' + c, iconSize: new L.Point(40, 40) });
			},
		});

		// 组1
		for (var i = 0; i < addressPoints.length / 2; i++) {
			var a = addressPoints[i];
			var title = a[2];
			var marker = L.marker(L.latLng(a[0], a[1]), { title: title }); ""
			marker.options.groupName = 'group1'
			marker.bindPopup(title);
			markers.addLayer(marker);
		}
		// 组2
		for (var i = Math.floor(addressPoints.length / 2); i < addressPoints.length; i++) {
			var a = addressPoints[i];
			var title = a[2];
			var marker = L.marker(L.latLng(a[0], a[1]), { title: title });
			marker.options.groupName = 'group2'
			marker.bindPopup(title);
			markers.addLayer(marker);
		}
		markers.on('clusterclick',(e)=>{
			console.log('e: ', e);

		})

		map.addLayer(markers);

	</script>
</body>

</html>